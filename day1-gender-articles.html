<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tag 1 ¬∑ Gender & Articles Foundation</title>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&family=Crimson+Pro:wght@300;600&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-main: #faf9f7;
            --bg-card: #ffffff;
            --text-primary: #2d2d2d;
            --text-secondary: #6b6b6b;
            --accent-a1: #ffa07a;
            --accent-a2: #98d8c8;
            --accent-der: #ff6b6b;
            --accent-die: #4ecdc4;
            --accent-das: #ffd93d;
            --success: #4ade80;
            --error: #ef4444;
            --shadow-soft: 0 8px 30px rgba(0, 0, 0, 0.06);
            --shadow-hover: 0 12px 40px rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: 'DM Sans', sans-serif;
            background: var(--bg-main);
            color: var(--text-primary);
            line-height: 1.7;
            padding: 0;
            background-image: 
                radial-gradient(circle at 20% 50%, rgba(255, 160, 122, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(152, 216, 200, 0.1) 0%, transparent 50%);
        }

        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        /* Sticky Progress Bar */
        .progress-bar-container {
            position: sticky;
            top: 0;
            background: var(--bg-card);
            padding: 20px;
            box-shadow: var(--shadow-soft);
            z-index: 100;
            border-bottom: 3px solid var(--accent-a1);
            margin-bottom: 40px;
        }

        .progress-bar-title {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .progress-bar {
            width: 100%;
            height: 12px;
            background: var(--bg-main);
            border-radius: 20px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-a1), var(--accent-a2));
            border-radius: 20px;
            transition: width 0.5s ease;
            width: 0%;
        }

        .progress-text {
            margin-top: 8px;
            font-size: 0.85rem;
            color: var(--text-secondary);
            display: flex;
            justify-content: space-between;
        }

        /* Header */
        header {
            text-align: center;
            padding: 60px 20px 40px;
            margin-bottom: 60px;
        }

        .day-number {
            font-size: 0.9rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 10px;
            font-weight: 500;
        }

        h1 {
            font-family: 'Crimson Pro', serif;
            font-size: 3.5rem;
            font-weight: 300;
            color: var(--text-primary);
            margin-bottom: 15px;
            letter-spacing: -1px;
        }

        .subtitle {
            font-size: 1.1rem;
            color: var(--text-secondary);
            font-weight: 400;
        }

        /* Phase Sections */
        .phase-section {
            margin-bottom: 80px;
            opacity: 0;
            animation: fadeInUp 0.6s ease forwards;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .phase-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .phase-icon {
            font-size: 2.5rem;
        }

        .phase-title {
            font-family: 'Crimson Pro', serif;
            font-size: 2.2rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .phase-badge {
            margin-left: auto;
            padding: 8px 20px;
            background: var(--bg-card);
            border-radius: 20px;
            font-size: 0.85rem;
            color: var(--text-secondary);
            border: 1px solid rgba(0, 0, 0, 0.05);
            box-shadow: var(--shadow-soft);
        }

        .phase-badge.completed {
            background: var(--success);
            color: white;
            border-color: var(--success);
        }

        .phase-badge.locked {
            background: var(--bg-main);
            color: var(--text-secondary);
        }

        /* Content Cards */
        .content-card {
            background: var(--bg-card);
            padding: 40px;
            border-radius: 25px;
            margin-bottom: 30px;
            box-shadow: var(--shadow-soft);
            transition: all 0.4s ease;
        }

        .content-card.collapsed {
            padding: 20px 40px;
        }

        .content-card.collapsed .collapsible-content {
            display: none;
        }

        .collapse-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            user-select: none;
        }

        .collapse-toggle {
            font-size: 1.5rem;
            color: var(--accent-a1);
            transition: transform 0.3s ease;
        }

        .content-card.collapsed .collapse-toggle {
            transform: rotate(180deg);
        }

        .content-card h3 {
            font-family: 'Crimson Pro', serif;
            font-size: 1.8rem;
            margin-bottom: 20px;
            color: var(--text-primary);
            font-weight: 600;
        }

        /* Learning Groups */
        .learning-group {
            background: var(--bg-main);
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 25px;
            border-left: 5px solid var(--accent-a1);
            box-shadow: var(--shadow-soft);
        }

        .learning-group.locked {
            opacity: 0.5;
            pointer-events: none;
        }

        .group-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .group-title {
            font-family: 'Crimson Pro', serif;
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .group-progress {
            font-size: 0.9rem;
            color: var(--text-secondary);
            background: var(--bg-card);
            padding: 6px 15px;
            border-radius: 15px;
        }

        /* Flashcard Grid */
        .flashcard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .mini-flashcard {
            background: var(--bg-card);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: var(--shadow-soft);
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .mini-flashcard:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-hover);
        }

        .mini-flashcard.clicked {
            border-color: var(--success);
            background: rgba(74, 222, 128, 0.1);
        }

        .flashcard-word {
            font-family: 'Crimson Pro', serif;
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .flashcard-translation {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-top: 5px;
        }

        /* Interactive Quiz */
        .quiz-container {
            background: var(--bg-card);
            padding: 40px;
            border-radius: 25px;
            box-shadow: var(--shadow-soft);
            margin: 30px 0;
        }

        .quiz-question {
            text-align: center;
            margin-bottom: 30px;
        }

        .quiz-word {
            font-family: 'Crimson Pro', serif;
            font-size: 3rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 20px;
        }

        .quiz-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .quiz-btn {
            padding: 15px 40px;
            font-size: 1.2rem;
            font-weight: 600;
            border: 2px solid;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: var(--bg-card);
            font-family: 'DM Sans', sans-serif;
        }

        .quiz-btn.der {
            border-color: var(--accent-der);
            color: var(--accent-der);
        }

        .quiz-btn.die {
            border-color: var(--accent-die);
            color: var(--accent-die);
        }

        .quiz-btn.das {
            border-color: var(--accent-das);
            color: var(--accent-das);
        }

        .quiz-btn:hover {
            transform: scale(1.05);
            box-shadow: var(--shadow-hover);
        }

        .quiz-btn.correct {
            background: var(--success);
            color: white;
            border-color: var(--success);
        }

        .quiz-btn.wrong {
            background: var(--error);
            color: white;
            border-color: var(--error);
            animation: shake 0.3s ease;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .quiz-score {
            text-align: center;
            font-size: 1.2rem;
            color: var(--text-secondary);
            margin-top: 20px;
        }

        .quiz-score strong {
            color: var(--accent-a1);
            font-size: 1.5rem;
        }

        /* Input Boxes */
        .input-box {
            width: 100%;
            padding: 15px 20px;
            font-size: 1rem;
            border: 2px solid rgba(0, 0, 0, 0.1);
            border-radius: 12px;
            font-family: 'DM Sans', sans-serif;
            margin: 10px 0;
            transition: all 0.3s ease;
        }

        .input-box:focus {
            outline: none;
            border-color: var(--accent-a1);
            box-shadow: 0 0 0 3px rgba(255, 160, 122, 0.1);
        }

        .input-box.correct {
            border-color: var(--success);
            background: rgba(74, 222, 128, 0.05);
        }

        .input-box.wrong {
            border-color: var(--error);
            background: rgba(239, 68, 68, 0.05);
        }

        /* Drill Area */
        .drill-container {
            background: var(--bg-card);
            padding: 40px;
            border-radius: 25px;
            box-shadow: var(--shadow-soft);
            margin: 30px 0;
            position: relative;
        }

        .drill-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .drill-title {
            font-family: 'Crimson Pro', serif;
            font-size: 1.8rem;
            font-weight: 600;
        }

        .drill-counter {
            font-size: 1.2rem;
            color: var(--text-secondary);
        }

        .drill-counter strong {
            color: var(--accent-a1);
            font-size: 1.5rem;
        }

        .drill-textarea {
            width: 100%;
            min-height: 400px;
            padding: 20px;
            font-size: 1rem;
            line-height: 2;
            border: 2px solid rgba(0, 0, 0, 0.05);
            border-radius: 15px;
            font-family: 'DM Sans', sans-serif;
            resize: vertical;
            transition: all 0.3s ease;
        }

        .drill-textarea:focus {
            outline: none;
            border-color: var(--accent-a1);
            box-shadow: 0 0 0 3px rgba(255, 160, 122, 0.1);
        }

        /* Help Panel */
        .help-panel {
            position: fixed;
            right: -350px;
            top: 50%;
            transform: translateY(-50%);
            width: 320px;
            max-height: 80vh;
            overflow-y: auto;
            background: var(--bg-card);
            padding: 25px;
            border-radius: 20px 0 0 20px;
            box-shadow: -5px 0 30px rgba(0, 0, 0, 0.1);
            transition: right 0.4s ease;
            z-index: 90;
        }

        .help-panel.visible {
            right: 0;
        }

        .help-toggle {
            position: fixed;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            background: var(--accent-a1);
            color: white;
            padding: 15px 10px;
            border-radius: 10px 0 0 10px;
            cursor: pointer;
            font-size: 1.2rem;
            z-index: 91;
            transition: all 0.3s ease;
        }

        .help-toggle:hover {
            padding-right: 15px;
        }

        .help-vocab-list {
            list-style: none;
            padding: 0;
        }

        .help-vocab-item {
            padding: 10px;
            margin: 5px 0;
            background: var(--bg-main);
            border-radius: 8px;
            font-size: 0.95rem;
            border-left: 3px solid;
        }

        .help-vocab-item.der { border-left-color: var(--accent-der); }
        .help-vocab-item.die { border-left-color: var(--accent-die); }
        .help-vocab-item.das { border-left-color: var(--accent-das); }

        /* Buttons */
        .btn {
            padding: 12px 30px;
            font-size: 1rem;
            font-weight: 600;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'DM Sans', sans-serif;
        }

        .btn-primary {
            background: var(--accent-a1);
            color: white;
        }

        .btn-primary:hover {
            background: #ff8c5a;
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
        }

        .btn-secondary {
            background: var(--bg-main);
            color: var(--text-primary);
            border: 2px solid rgba(0, 0, 0, 0.1);
        }

        .btn-secondary:hover {
            background: var(--bg-card);
            transform: translateY(-2px);
        }

        /* Checkpoint Quiz */
        .checkpoint-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 200;
            align-items: center;
            justify-content: center;
        }

        .checkpoint-modal.active {
            display: flex;
        }

        .checkpoint-content {
            background: var(--bg-card);
            padding: 50px;
            border-radius: 30px;
            max-width: 600px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .checkpoint-title {
            font-family: 'Crimson Pro', serif;
            font-size: 2rem;
            text-align: center;
            margin-bottom: 30px;
            color: var(--text-primary);
        }

        /* Badges */
        .badge-container {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .badge {
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .badge.locked {
            background: var(--bg-main);
            color: var(--text-secondary);
            opacity: 0.5;
        }

        .badge.earned {
            background: linear-gradient(135deg, var(--accent-a1), var(--accent-a2));
            color: white;
            animation: earnBadge 0.5s ease;
        }

        @keyframes earnBadge {
            0% { transform: scale(0); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        /* Completion Card */
        .completion-card {
            background: linear-gradient(135deg, var(--accent-a1), var(--accent-a2));
            color: white;
            padding: 60px 40px;
            border-radius: 30px;
            text-align: center;
            box-shadow: var(--shadow-hover);
            margin: 60px 0;
        }

        .completion-card h2 {
            font-family: 'Crimson Pro', serif;
            font-size: 2.5rem;
            margin-bottom: 20px;
        }

        .completion-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .stat-box {
            background: rgba(255, 255, 255, 0.2);
            padding: 20px;
            border-radius: 15px;
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        /* Responsive */
        @media (max-width: 768px) {
            h1 {
                font-size: 2.5rem;
            }

            .phase-title {
                font-size: 1.8rem;
            }

            .help-panel {
                width: 280px;
            }

            .quiz-word {
                font-size: 2rem;
            }

            .content-card {
                padding: 25px;
            }
        }

        /* Confetti Animation */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: var(--accent-a1);
            position: absolute;
            animation: confetti-fall 3s linear;
        }

        @keyframes confetti-fall {
            to {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }
    </style>
</head>
<body>
    <!-- Sticky Progress Bar -->
    <div class="progress-bar-container">
        <div class="progress-bar-title">Day 1 Progress</div>
        <div class="progress-bar">
            <div class="progress-fill" id="mainProgress"></div>
        </div>
        <div class="progress-text">
            <span id="progressPhase">Phase 1A: Active Learning</span>
            <span id="progressPercent">0%</span>
        </div>
    </div>

    <div class="container">
        <header>
            <div class="day-number">Woche 1 ¬∑ Tag 1</div>
            <h1>Gender & Articles Foundation</h1>
            <p class="subtitle">Master der/die/das through active learning, quizzes, and intensive drilling</p>
        </header>

        <!-- Today's Goals -->
        <div class="content-card" id="goalsCard">
            <div class="collapse-header" onclick="toggleCollapse('goalsCard')">
                <h3>üéØ Today's Mission</h3>
                <span class="collapse-toggle">‚ñº</span>
            </div>
            <div class="collapsible-content">
                <div class="badge-container">
                    <div class="badge locked" id="badge-nouns">üìö 50 Nouns Mastered</div>
                    <div class="badge locked" id="badge-quiz">üß† Quiz Perfect Score</div>
                    <div class="badge locked" id="badge-sentences">‚úçÔ∏è 300+ Sentences</div>
                    <div class="badge locked" id="badge-complete">üèÜ Day 1 Complete</div>
                </div>
                <ul style="list-style: none; padding: 0; margin-top: 20px;">
                    <li style="padding: 10px 0; border-bottom: 1px solid var(--bg-main);">‚úÖ Learn 50 core German nouns with their genders</li>
                    <li style="padding: 10px 0; border-bottom: 1px solid var(--bg-main);">‚úÖ Pass the master quiz (80%+ required)</li>
                    <li style="padding: 10px 0; border-bottom: 1px solid var(--bg-main);">‚úÖ Write 200+ drill sentences</li>
                    <li style="padding: 10px 0; border-bottom: 1px solid var(--bg-main);">‚úÖ Master personal pronouns</li>
                    <li style="padding: 10px 0;">‚úÖ Practice listening & speaking</li>
                </ul>
            </div>
        </div>

        <!-- PART 1: THEORY -->
        <div class="phase-section">
            <div class="phase-header">
                <span class="phase-icon">üìö</span>
                <h2 class="phase-title">Part 1: Theory</h2>
                <span class="phase-badge" id="badge-theory">‚è± 15 min</span>
            </div>

            <div class="content-card" id="theoryCard">
                <div class="collapse-header" onclick="toggleCollapse('theoryCard')">
                    <h3>Why Gender Matters</h3>
                    <span class="collapse-toggle">‚ñº</span>
                </div>
                <div class="collapsible-content">
                    <p style="margin-bottom: 15px;">German nouns have <strong>grammatical gender</strong> (not biological). Every noun is masculine (der), feminine (die), or neuter (das).</p>
                    <p style="margin-bottom: 15px;"><strong>Why this is critical:</strong> Gender affects EVERYTHING downstream:</p>
                    <ul style="margin-left: 25px; margin-bottom: 15px;">
                        <li>Articles: der/die/das, ein/eine/ein</li>
                        <li>Adjective endings: der gro√üe Mann, die gro√üe Frau</li>
                        <li>Pronouns: er (he/it-masc), sie (she/it-fem), es (it-neut)</li>
                        <li>Cases: der‚Üíden (accusative)</li>
                    </ul>
                    <p style="background: linear-gradient(120deg, rgba(255, 160, 122, 0.2) 0%, rgba(255, 160, 122, 0.1) 100%); padding: 15px; border-radius: 10px; font-weight: 600;">üí° You MUST memorize each noun with its article as a single unit: "der Tisch", NOT "Tisch".</p>
                    
                    <h4 style="margin-top: 30px; margin-bottom: 15px; font-size: 1.3rem;">Gender Patterns (Your Secret Weapon)</h4>
                    <table style="width: 100%; border-collapse: collapse; margin: 20px 0;">
                        <thead>
                            <tr style="background: var(--bg-main);">
                                <th style="padding: 12px; text-align: left;">Gender</th>
                                <th style="padding: 12px; text-align: left;">Pattern</th>
                                <th style="padding: 12px; text-align: left;">Examples</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="padding: 12px; border-bottom: 1px solid var(--bg-main);"><strong style="color: var(--accent-die);">DIE</strong></td>
                                <td style="padding: 12px; border-bottom: 1px solid var(--bg-main);">-ung, -heit, -keit, -schaft, -ion</td>
                                <td style="padding: 12px; border-bottom: 1px solid var(--bg-main);">Wohnung, Freiheit, M√∂glichkeit</td>
                            </tr>
                            <tr>
                                <td style="padding: 12px; border-bottom: 1px solid var(--bg-main);"><strong style="color: var(--accent-die);">DIE</strong></td>
                                <td style="padding: 12px; border-bottom: 1px solid var(--bg-main);">-e (80% of time)</td>
                                <td style="padding: 12px; border-bottom: 1px solid var(--bg-main);">Lampe, Tasse, Blume</td>
                            </tr>
                            <tr>
                                <td style="padding: 12px; border-bottom: 1px solid var(--bg-main);"><strong style="color: var(--accent-der);">DER</strong></td>
                                <td style="padding: 12px; border-bottom: 1px solid var(--bg-main);">-er, -en, -el, -ling</td>
                                <td style="padding: 12px; border-bottom: 1px solid var(--bg-main);">Lehrer, Garten, Apfel</td>
                            </tr>
                            <tr>
                                <td style="padding: 12px; border-bottom: 1px solid var(--bg-main);"><strong style="color: var(--accent-der);">DER</strong></td>
                                <td style="padding: 12px; border-bottom: 1px solid var(--bg-main);">Days, months, seasons</td>
                                <td style="padding: 12px; border-bottom: 1px solid var(--bg-main);">Montag, Januar, Sommer</td>
                            </tr>
                            <tr>
                                <td style="padding: 12px; border-bottom: 1px solid var(--bg-main);"><strong style="color: var(--accent-das);">DAS</strong></td>
                                <td style="padding: 12px; border-bottom: 1px solid var(--bg-main);">-chen, -lein (diminutives)</td>
                                <td style="padding: 12px; border-bottom: 1px solid var(--bg-main);">M√§dchen, Fr√§ulein</td>
                            </tr>
                            <tr>
                                <td style="padding: 12px;"><strong style="color: var(--accent-das);">DAS</strong></td>
                                <td style="padding: 12px;">-um, -ment</td>
                                <td style="padding: 12px;">Zentrum, Dokument</td>
                            </tr>
                        </tbody>
                    </table>

                    <button class="btn btn-primary" onclick="completeTheory()" style="margin-top: 20px;">‚úì I've Read the Theory</button>
                </div>
            </div>
        </div>

        <!-- PART 2: ACTIVE LEARNING -->
        <div class="phase-section" id="phase2">
            <div class="phase-header">
                <span class="phase-icon">üî•</span>
                <h2 class="phase-title">Part 2: Active Learning</h2>
                <span class="phase-badge locked" id="badge-phase2">üîí Locked</span>
            </div>

            <div id="learningGroups">
                <!-- Learning groups will be generated by JavaScript -->
            </div>
        </div>

        <!-- PART 3: MASTER QUIZ -->
        <div class="phase-section" id="phase3" style="display: none;">
            <div class="phase-header">
                <span class="phase-icon">üß™</span>
                <h2 class="phase-title">Part 3: Master Quiz</h2>
                <span class="phase-badge locked" id="badge-phase3">üîí Locked</span>
            </div>

            <div class="quiz-container" id="masterQuiz">
                <div class="quiz-question">
                    <div class="quiz-word" id="quizWord">___</div>
                    <p style="color: var(--text-secondary); margin-bottom: 30px;">What is the correct article?</p>
                    <div class="quiz-buttons">
                        <button class="quiz-btn der" onclick="checkQuizAnswer('der')">der</button>
                        <button class="quiz-btn die" onclick="checkQuizAnswer('die')">die</button>
                        <button class="quiz-btn das" onclick="checkQuizAnswer('das')">das</button>
                    </div>
                </div>
                <div class="quiz-score">
                    Score: <strong><span id="quizScore">0</span>/<span id="quizTotal">50</span></strong>
                </div>
            </div>
        </div>

        <!-- PART 4: FREE DRILLING -->
        <div class="phase-section" id="phase4" style="display: none;">
            <div class="phase-header">
                <span class="phase-icon">‚úçÔ∏è</span>
                <h2 class="phase-title">Part 4: Free Drilling</h2>
                <span class="phase-badge locked" id="badge-phase4">üîí Locked</span>
            </div>

            <div class="drill-container">
                <div class="drill-header">
                    <h3 class="drill-title">Write 200 Sentences</h3>
                    <div class="drill-counter">
                        <strong><span id="sentenceCount">0</span></strong> / 200
                    </div>
                </div>
                <p style="color: var(--text-secondary); margin-bottom: 20px;">Write sentences using the pattern "Das ist der/die/das ___" or add descriptions like "Der Mann ist gro√ü."</p>
                <textarea class="drill-textarea" id="drillTextarea" placeholder="Start writing...&#10;Das ist der Mann.&#10;Das ist die Frau.&#10;Das ist das Kind.&#10;..."></textarea>
                <div style="margin-top: 15px; color: var(--text-secondary); font-size: 0.9rem;">
                    üí° Tip: Click the help button on the right if you need to see the noun list!
                </div>
            </div>
        </div>

        <!-- PART 5: PRONOUNS -->
        <div class="phase-section" id="phase5" style="display: none;">
            <div class="phase-header">
                <span class="phase-icon">üë§</span>
                <h2 class="phase-title">Part 5: Personal Pronouns</h2>
                <span class="phase-badge locked" id="badge-phase5">üîí Locked</span>
            </div>

            <div class="content-card">
                <h3>Personal Pronouns (Must-Know)</h3>
                <table style="width: 100%; border-collapse: collapse; margin: 20px 0;">
                    <thead>
                        <tr style="background: var(--bg-main);">
                            <th style="padding: 12px; text-align: left;">German</th>
                            <th style="padding: 12px; text-align: left;">English</th>
                            <th style="padding: 12px; text-align: left;">Example</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td style="padding: 12px; border-bottom: 1px solid var(--bg-main);"><strong>ich</strong></td>
                            <td style="padding: 12px; border-bottom: 1px solid var(--bg-main);">I</td>
                            <td style="padding: 12px; border-bottom: 1px solid var(--bg-main);">Ich bin Student.</td>
                        </tr>
                        <tr>
                            <td style="padding: 12px; border-bottom: 1px solid var(--bg-main);"><strong>du</strong></td>
                            <td style="padding: 12px; border-bottom: 1px solid var(--bg-main);">you (informal)</td>
                            <td style="padding: 12px; border-bottom: 1px solid var(--bg-main);">Du bist nett.</td>
                        </tr>
                        <tr>
                            <td style="padding: 12px; border-bottom: 1px solid var(--bg-main);"><strong>er/sie/es</strong></td>
                            <td style="padding: 12px; border-bottom: 1px solid var(--bg-main);">he/she/it</td>
                            <td style="padding: 12px; border-bottom: 1px solid var(--bg-main);">Er ist gro√ü.</td>
                        </tr>
                        <tr>
                            <td style="padding: 12px; border-bottom: 1px solid var(--bg-main);"><strong>wir</strong></td>
                            <td style="padding: 12px; border-bottom: 1px solid var(--bg-main);">we</td>
                            <td style="padding: 12px; border-bottom: 1px solid var(--bg-main);">Wir sind Freunde.</td>
                        </tr>
                        <tr>
                            <td style="padding: 12px; border-bottom: 1px solid var(--bg-main);"><strong>ihr</strong></td>
                            <td style="padding: 12px; border-bottom: 1px solid var(--bg-main);">you (plural)</td>
                            <td style="padding: 12px; border-bottom: 1px solid var(--bg-main);">Ihr seid m√ºde.</td>
                        </tr>
                        <tr>
                            <td style="padding: 12px; border-bottom: 1px solid var(--bg-main);"><strong>sie</strong></td>
                            <td style="padding: 12px; border-bottom: 1px solid var(--bg-main);">they</td>
                            <td style="padding: 12px; border-bottom: 1px solid var(--bg-main);">Sie sind Studenten.</td>
                        </tr>
                        <tr>
                            <td style="padding: 12px;"><strong>Sie</strong></td>
                            <td style="padding: 12px;">you (formal)</td>
                            <td style="padding: 12px;">Sie sind Herr Schmidt.</td>
                        </tr>
                    </tbody>
                </table>

                <div class="drill-container" style="margin-top: 30px;">
                    <h4 style="margin-bottom: 15px;">Quick Drill: Write 30 Sentences</h4>
                    <textarea class="drill-textarea" id="pronounTextarea" placeholder="Write 30 sentences using pronouns...&#10;Ich bin Student.&#10;Du bist nett.&#10;Er ist gro√ü.&#10;..."></textarea>
                    <div style="margin-top: 15px; color: var(--text-secondary);">
                        Sentences: <strong style="color: var(--accent-a1);"><span id="pronounCount">0</span> / 30</strong>
                    </div>
                </div>

                <button class="btn btn-primary" onclick="completePronounPhase()" style="margin-top: 20px;">‚úì Complete Pronouns</button>
            </div>
        </div>

        <!-- PART 6: ADJECTIVES -->
        <div class="phase-section" id="phase6" style="display: none;">
            <div class="phase-header">
                <span class="phase-icon">üé®</span>
                <h2 class="phase-title">Part 6: Adjective Practice</h2>
                <span class="phase-badge locked" id="badge-phase6">üîí Locked</span>
            </div>

            <div class="content-card">
                <h3>Core Adjectives</h3>
                <div style="display: flex; gap: 10px; flex-wrap: wrap; margin: 20px 0;">
                    <span style="padding: 8px 15px; background: var(--bg-main); border-radius: 10px;">gro√ü (big)</span>
                    <span style="padding: 8px 15px; background: var(--bg-main); border-radius: 10px;">klein (small)</span>
                    <span style="padding: 8px 15px; background: var(--bg-main); border-radius: 10px;">alt (old)</span>
                    <span style="padding: 8px 15px; background: var(--bg-main); border-radius: 10px;">neu (new)</span>
                    <span style="padding: 8px 15px; background: var(--bg-main); border-radius: 10px;">sch√∂n (beautiful)</span>
                    <span style="padding: 8px 15px; background: var(--bg-main); border-radius: 10px;">gut (good)</span>
                    <span style="padding: 8px 15px; background: var(--bg-main); border-radius: 10px;">schlecht (bad)</span>
                    <span style="padding: 8px 15px; background: var(--bg-main); border-radius: 10px;">nett (nice)</span>
                    <span style="padding: 8px 15px; background: var(--bg-main); border-radius: 10px;">interessant (interesting)</span>
                </div>

                <div class="drill-container" style="margin-top: 30px;">
                    <h4 style="margin-bottom: 15px;">Creative Drill: Write 50 Sentences</h4>
                    <p style="color: var(--text-secondary); margin-bottom: 15px;">Combine nouns + adjectives: "Der Tisch ist braun und gro√ü."</p>
                    <textarea class="drill-textarea" id="adjectiveTextarea" placeholder="Write 50 creative sentences...&#10;Der Tisch ist braun und gro√ü.&#10;Die Lampe ist alt aber sch√∂n.&#10;..."></textarea>
                    <div style="margin-top: 15px; color: var(--text-secondary);">
                        Sentences: <strong style="color: var(--accent-a1);"><span id="adjectiveCount">0</span> / 50</strong>
                    </div>
                </div>

                <button class="btn btn-primary" onclick="completeAdjectivePhase()" style="margin-top: 20px;">‚úì Complete Adjectives</button>
            </div>
        </div>

        <!-- PART 7: LISTENING & SPEAKING -->
        <div class="phase-section" id="phase7" style="display: none;">
            <div class="phase-header">
                <span class="phase-icon">üéß</span>
                <h2 class="phase-title">Part 7: Listening & Speaking</h2>
                <span class="phase-badge locked" id="badge-phase7">üîí Locked</span>
            </div>

            <div class="content-card">
                <h3>üéß Listening Practice (15 minutes)</h3>
                <p style="margin-bottom: 15px;"><strong>Resources to use:</strong></p>
                <ul style="margin-left: 25px; margin-bottom: 20px;">
                    <li>Easy German Podcast - Episode 1 or any A1 episode</li>
                    <li>Deutsche Welle A1 - "Nicos Weg" series (free online)</li>
                    <li>YouTube: Search "German A1 listening"</li>
                </ul>
                <p style="margin-bottom: 15px;"><strong>Focus on:</strong></p>
                <ul style="margin-left: 25px; margin-bottom: 20px;">
                    <li>Can you hear der/die/das?</li>
                    <li>Catch familiar nouns from today</li>
                    <li>Don't worry about understanding everything</li>
                </ul>
                <label style="display: flex; align-items: center; gap: 10px; cursor: pointer; margin-top: 20px;">
                    <input type="checkbox" id="listeningCheck" style="width: 20px; height: 20px; cursor: pointer;">
                    <span>‚úì I completed 15 minutes of listening</span>
                </label>
            </div>

            <div class="content-card" style="margin-top: 30px;">
                <h3>üó£Ô∏è Speaking Practice (15 minutes)</h3>
                <p style="margin-bottom: 15px;"><strong>Exercise 1: Vocabulary Repetition (5 min)</strong></p>
                <ul style="margin-left: 25px; margin-bottom: 20px;">
                    <li>Record yourself saying each of 50 nouns 3x with article</li>
                    <li>Focus on pronunciation and article clarity</li>
                </ul>
                <p style="margin-bottom: 15px;"><strong>Exercise 2: Sentence Creation (5 min)</strong></p>
                <ul style="margin-left: 25px; margin-bottom: 20px;">
                    <li>Look around your room</li>
                    <li>Describe 10 things: "Das ist der Tisch. Das ist die Lampe."</li>
                </ul>
                <p style="margin-bottom: 15px;"><strong>Exercise 3: Shadowing (5 min)</strong></p>
                <ul style="margin-left: 25px; margin-bottom: 20px;">
                    <li>Play a short German audio clip</li>
                    <li>Repeat exactly what you hear</li>
                </ul>
                <label style="display: flex; align-items: center; gap: 10px; cursor: pointer; margin-top: 20px;">
                    <input type="checkbox" id="speakingCheck" style="width: 20px; height: 20px; cursor: pointer;">
                    <span>‚úì I completed 15 minutes of speaking</span>
                </label>
            </div>

            <button class="btn btn-primary" onclick="completeDay1()" style="margin-top: 30px; width: 100%; padding: 20px; font-size: 1.2rem;">üéâ Complete Day 1!</button>
        </div>

        <!-- Completion Card (hidden initially) -->
        <div class="completion-card" id="completionCard" style="display: none;">
            <h2>üéâ Tag 1 Complete!</h2>
            <p style="font-size: 1.2rem; margin-bottom: 30px;">You've built a solid foundation. Here's what you accomplished:</p>
            <div class="completion-stats">
                <div class="stat-box">
                    <div class="stat-number" id="finalNouns">50</div>
                    <div class="stat-label">Nouns Mastered</div>
                </div>
                <div class="stat-box">
                    <div class="stat-number" id="finalSentences">300+</div>
                    <div class="stat-label">Sentences Written</div>
                </div>
                <div class="stat-box">
                    <div class="stat-number" id="finalQuiz">100%</div>
                    <div class="stat-label">Quiz Score</div>
                </div>
                <div class="stat-box">
                    <div class="stat-number">4</div>
                    <div class="stat-label">Hours Invested</div>
                </div>
            </div>
            <p style="font-size: 1.1rem; margin-top: 30px;">Tomorrow: <strong>Verb Conjugations</strong>. Rest up‚Äîyou've earned it! üí™</p>
            <button class="btn btn-secondary" style="margin-top: 20px; color: white; background: rgba(255,255,255,0.2); border: 2px solid white;" onclick="window.location.href='index.html'">‚Üê Back to Roadmap</button>
        </div>
    </div>

    <!-- Help Panel -->
    <div class="help-toggle" onclick="toggleHelp()">üëÄ</div>
    <div class="help-panel" id="helpPanel">
        <h4 style="margin-bottom: 20px; font-family: 'Crimson Pro', serif; font-size: 1.5rem;">Noun Reference</h4>
        <ul class="help-vocab-list" id="helpVocabList">
            <!-- Will be populated by JavaScript -->
        </ul>
    </div>

    <!-- Checkpoint Modal -->
    <div class="checkpoint-modal" id="checkpointModal">
        <div class="checkpoint-content">
            <h3 class="checkpoint-title">‚ö° Checkpoint Quiz!</h3>
            <p style="text-align: center; color: var(--text-secondary); margin-bottom: 30px;">Quick check to keep you sharp</p>
            <div id="checkpointQuestion"></div>
        </div>
    </div>

    <script>
        // Data
        const nouns = [
            // DER words (20)
            {word: 'Mann', article: 'der', translation: 'man', gender: 'der'},
            {word: 'Tag', article: 'der', translation: 'day', gender: 'der'},
            {word: 'Tisch', article: 'der', translation: 'table', gender: 'der'},
            {word: 'Stuhl', article: 'der', translation: 'chair', gender: 'der'},
            {word: 'Hund', article: 'der', translation: 'dog', gender: 'der'},
            {word: 'Baum', article: 'der', translation: 'tree', gender: 'der'},
            {word: 'Apfel', article: 'der', translation: 'apple', gender: 'der'},
            {word: 'Stift', article: 'der', translation: 'pen', gender: 'der'},
            {word: 'Lehrer', article: 'der', translation: 'teacher (m)', gender: 'der'},
            {word: 'Freund', article: 'der', translation: 'friend (m)', gender: 'der'},
            {word: 'Kaffee', article: 'der', translation: 'coffee', gender: 'der'},
            {word: 'K√§se', article: 'der', translation: 'cheese', gender: 'der'},
            {word: 'Bahnhof', article: 'der', translation: 'train station', gender: 'der'},
            {word: 'Name', article: 'der', translation: 'name', gender: 'der'},
            {word: 'Computer', article: 'der', translation: 'computer', gender: 'der'},
            {word: 'Platz', article: 'der', translation: 'place', gender: 'der'},
            {word: 'Kopf', article: 'der', translation: 'head', gender: 'der'},
            {word: 'Winter', article: 'der', translation: 'winter', gender: 'der'},
            {word: 'Garten', article: 'der', translation: 'garden', gender: 'der'},
            {word: 'Sommer', article: 'der', translation: 'summer', gender: 'der'},
            
            // DIE words (20)
            {word: 'Frau', article: 'die', translation: 'woman', gender: 'die'},
            {word: 'Nacht', article: 'die', translation: 'night', gender: 'die'},
            {word: 'T√ºr', article: 'die', translation: 'door', gender: 'die'},
            {word: 'Lampe', article: 'die', translation: 'lamp', gender: 'die'},
            {word: 'Katze', article: 'die', translation: 'cat', gender: 'die'},
            {word: 'Blume', article: 'die', translation: 'flower', gender: 'die'},
            {word: 'Stra√üe', article: 'die', translation: 'street', gender: 'die'},
            {word: 'Schule', article: 'die', translation: 'school', gender: 'die'},
            {word: 'Lehrerin', article: 'die', translation: 'teacher (f)', gender: 'die'},
            {word: 'Freundin', article: 'die', translation: 'friend (f)', gender: 'die'},
            {word: 'Milch', article: 'die', translation: 'milk', gender: 'die'},
            {word: 'Stadt', article: 'die', translation: 'city', gender: 'die'},
            {word: 'Zeit', article: 'die', translation: 'time', gender: 'die'},
            {word: 'Arbeit', article: 'die', translation: 'work', gender: 'die'},
            {word: 'Tasche', article: 'die', translation: 'bag', gender: 'die'},
            {word: 'Hand', article: 'die', translation: 'hand', gender: 'die'},
            {word: 'Musik', article: 'die', translation: 'music', gender: 'die'},
            {word: 'Sonne', article: 'die', translation: 'sun', gender: 'die'},
            {word: 'Tasse', article: 'die', translation: 'cup', gender: 'die'},
            {word: 'K√ºche', article: 'die', translation: 'kitchen', gender: 'die'},
            
            // DAS words (10)
            {word: 'Kind', article: 'das', translation: 'child', gender: 'das'},
            {word: 'Haus', article: 'das', translation: 'house', gender: 'das'},
            {word: 'Fenster', article: 'das', translation: 'window', gender: 'das'},
            {word: 'Bett', article: 'das', translation: 'bed', gender: 'das'},
            {word: 'Auto', article: 'das', translation: 'car', gender: 'das'},
            {word: 'Wasser', article: 'das', translation: 'water', gender: 'das'},
            {word: 'Buch', article: 'das', translation: 'book', gender: 'das'},
            {word: 'Zimmer', article: 'das', translation: 'room', gender: 'das'},
            {word: 'Essen', article: 'das', translation: 'food', gender: 'das'},
            {word: 'Geld', article: 'das', translation: 'money', gender: 'das'},
            {word: 'Brot', article: 'das', translation: 'bread', gender: 'das'},
            {word: 'Land', article: 'das', translation: 'country', gender: 'das'},
            {word: 'Jahr', article: 'das', translation: 'year', gender: 'das'},
            {word: 'Problem', article: 'das', translation: 'problem', gender: 'das'},
            {word: 'Telefon', article: 'das', translation: 'telephone', gender: 'das'},
            {word: 'Gesicht', article: 'das', translation: 'face', gender: 'das'},
            {word: 'M√§dchen', article: 'das', translation: 'girl', gender: 'das'},
            {word: 'Wetter', article: 'das', translation: 'weather', gender: 'das'}
        ];

        // State
        let state = {
            currentGroup: 0,
            groupsCompleted: 0,
            nounsLearned: 0,
            quizIndex: 0,
            quizScore: 0,
            quizNouns: [],
            sentenceCount: 0,
            checkpointsPassed: 0,
            phase: 1
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            populateHelpPanel();
            updateProgress();
        });

        // Theory completion
        function completeTheory() {
            document.getElementById('badge-theory').classList.remove('locked');
            document.getElementById('badge-theory').textContent = '‚úì Complete';
            document.getElementById('badge-theory').classList.add('completed');
            document.getElementById('theoryCard').classList.add('collapsed');
            
            // Unlock Phase 2
            document.getElementById('badge-phase2').classList.remove('locked');
            document.getElementById('badge-phase2').textContent = '‚è± 60 min';
            generateLearningGroups();
            updateProgress();
        }

        // Generate learning groups
        function generateLearningGroups() {
            const container = document.getElementById('learningGroups');
            const groups = [
                {name: 'Group 1: DER Words (1-10)', nouns: nouns.slice(0, 10)},
                {name: 'Group 2: DER Words (11-20)', nouns: nouns.slice(10, 20)},
                {name: 'Group 3: DIE Words (1-10)', nouns: nouns.slice(20, 30)},
                {name: 'Group 4: DIE Words (11-20)', nouns: nouns.slice(30, 40)},
                {name: 'Group 5: DAS Words', nouns: nouns.slice(40, 50)}
            ];

            groups.forEach((group, index) => {
                const groupDiv = document.createElement('div');
                groupDiv.className = 'learning-group' + (index > 0 ? ' locked' : '');
                groupDiv.id = `group${index}`;
                
                groupDiv.innerHTML = `
                    <div class="group-header">
                        <h3 class="group-title">${group.name}</h3>
                        <span class="group-progress" id="progress${index}">Step 1/4</span>
                    </div>
                    
                    <!-- Step 1: Flashcard Study -->
                    <div id="step1-${index}">
                        <h4 style="margin-bottom: 15px;">Step 1: Study These Words (2 min)</h4>
                        <div class="flashcard-grid">
                            ${group.nouns.map(noun => `
                                <div class="mini-flashcard" onclick="this.classList.toggle('clicked')">
                                    <div class="flashcard-word">${noun.article} ${noun.word}</div>
                                    <div class="flashcard-translation">${noun.translation}</div>
                                </div>
                            `).join('')}
                        </div>
                        <button class="btn btn-primary" onclick="nextStep(${index}, 2)" style="margin-top: 20px;">Next: Memory Test ‚Üí</button>
                    </div>
                    
                    <!-- Step 2: Memory Test -->
                    <div id="step2-${index}" style="display: none;">
                        <h4 style="margin-bottom: 15px;">Step 2: Type the Correct Article (3 min)</h4>
                        ${group.nouns.map((noun, i) => `
                            <div style="display: flex; gap: 10px; align-items: center; margin-bottom: 10px;">
                                <input type="text" class="input-box" id="test-${index}-${i}" placeholder="${noun.word}" 
                                       data-answer="${noun.article}" style="width: 100px;">
                                <span style="flex: 1;">${noun.word} (${noun.translation})</span>
                                <span id="result-${index}-${i}" style="font-size: 1.5rem;"></span>
                            </div>
                        `).join('')}
                        <button class="btn btn-primary" onclick="checkMemoryTest(${index}, ${group.nouns.length})" style="margin-top: 20px;">Check Answers</button>
                    </div>
                    
                    <!-- Step 3: Write from Memory -->
                    <div id="step3-${index}" style="display: none;">
                        <h4 style="margin-bottom: 15px;">Step 3: Write All 10 from Memory (2 min)</h4>
                        <p style="color: var(--text-secondary); margin-bottom: 10px;">Write all 10 nouns with their articles (one per line):</p>
                        <textarea class="input-box" id="memory-${index}" rows="10" placeholder="der Mann&#10;die Frau&#10;..."></textarea>
                        <button class="btn btn-primary" onclick="nextStep(${index}, 4)" style="margin-top: 15px;">Next: Mini-Drill ‚Üí</button>
                    </div>
                    
                    <!-- Step 4: Mini-Drill -->
                    <div id="step4-${index}" style="display: none;">
                        <h4 style="margin-bottom: 15px;">Step 4: Write 10 Sentences (5 min)</h4>
                        <textarea class="input-box" id="drill-${index}" rows="12" placeholder="Das ist der Mann.&#10;Das ist die Frau.&#10;..."></textarea>
                        <div style="margin-top: 10px; color: var(--text-secondary);">
                            Sentences: <strong style="color: var(--accent-a1);"><span id="count-${index}">0</span> / 10</strong>
                        </div>
                        <button class="btn btn-primary" onclick="completeGroup(${index})" style="margin-top: 15px;">‚úì Complete Group ${index + 1}</button>
                    </div>
                `;
                
                container.appendChild(groupDiv);
                
                // Add sentence counter
                const textarea = groupDiv.querySelector(`#drill-${index}`);
                if (textarea) {
                    textarea.addEventListener('input', function() {
                        const lines = this.value.split('\n').filter(line => line.trim().length > 0);
                        document.getElementById(`count-${index}`).textContent = lines.length;
                    });
                }
            });
        }

        function nextStep(groupIndex, step) {
            document.getElementById(`step${step - 1}-${groupIndex}`).style.display = 'none';
            document.getElementById(`step${step}-${groupIndex}`).style.display = 'block';
            document.getElementById(`progress${groupIndex}`).textContent = `Step ${step}/4`;
        }

        function checkMemoryTest(groupIndex, count) {
            let correct = 0;
            for (let i = 0; i < count; i++) {
                const input = document.getElementById(`test-${groupIndex}-${i}`);
                const result = document.getElementById(`result-${groupIndex}-${i}`);
                const answer = input.dataset.answer;
                
                if (input.value.toLowerCase() === answer) {
                    input.classList.add('correct');
                    input.classList.remove('wrong');
                    result.textContent = '‚úì';
                    result.style.color = 'var(--success)';
                    correct++;
                } else {
                    input.classList.add('wrong');
                    input.classList.remove('correct');
                    result.textContent = '‚úó';
                    result.style.color = 'var(--error)';
                }
            }
            
            if (correct === count) {
                setTimeout(() => nextStep(groupIndex, 3), 1000);
            } else {
                alert(`You got ${correct}/${count} correct. Try again for the ones you missed!`);
            }
        }

        function completeGroup(index) {
            const lines = document.getElementById(`drill-${index}`).value.split('\n').filter(l => l.trim().length > 0);
            if (lines.length < 10) {
                alert('Please write at least 10 sentences before completing!');
                return;
            }
            
            state.groupsCompleted++;
            state.nounsLearned += 10;
            
            // Update badge
            const badge = document.getElementById('badge-nouns');
            badge.textContent = `üìö ${state.nounsLearned}/50 Nouns`;
            if (state.nounsLearned >= 50) {
                badge.classList.remove('locked');
                badge.classList.add('earned');
            }
            
            // Lock current group
            document.getElementById(`group${index}`).classList.add('locked');
            document.getElementById(`group${index}`).style.opacity = '0.7';
            
            // Unlock next group or quiz
            if (index < 4) {
                document.getElementById(`group${index + 1}`).classList.remove('locked');
            } else {
                // All groups complete - unlock quiz
                unlockPhase3();
            }
            
            updateProgress();
        }

        function unlockPhase3() {
            document.getElementById('phase3').style.display = 'block';
            document.getElementById('badge-phase3').classList.remove('locked');
            document.getElementById('badge-phase3').textContent = '‚è± 30 min';
            
            // Prepare quiz
            state.quizNouns = [...nouns].sort(() => Math.random() - 0.5);
            showNextQuizQuestion();
            
            // Scroll to quiz
            document.getElementById('phase3').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function showNextQuizQuestion() {
            if (state.quizIndex >= 50) {
                completeQuiz();
                return;
            }
            
            const noun = state.quizNouns[state.quizIndex];
            document.getElementById('quizWord').textContent = noun.word;
            document.getElementById('quizScore').textContent = state.quizScore;
            document.getElementById('quizTotal').textContent = '50';
            
            // Reset button states
            document.querySelectorAll('.quiz-btn').forEach(btn => {
                btn.classList.remove('correct', 'wrong');
                btn.disabled = false;
            });
        }

        function checkQuizAnswer(answer) {
            const noun = state.quizNouns[state.quizIndex];
            const buttons = document.querySelectorAll('.quiz-btn');
            
            buttons.forEach(btn => btn.disabled = true);
            
            if (answer === noun.article) {
                document.querySelector(`.quiz-btn.${answer}`).classList.add('correct');
                state.quizScore++;
                setTimeout(() => {
                    state.quizIndex++;
                    showNextQuizQuestion();
                }, 500);
            } else {
                document.querySelector(`.quiz-btn.${answer}`).classList.add('wrong');
                setTimeout(() => {
                    document.querySelector(`.quiz-btn.${noun.article}`).classList.add('correct');
                    setTimeout(() => {
                        state.quizIndex++;
                        showNextQuizQuestion();
                    }, 1000);
                }, 500);
            }
        }

        function completeQuiz() {
            const percentage = (state.quizScore / 50 * 100).toFixed(0);
            
            if (percentage >= 80) {
                // Pass!
                document.getElementById('masterQuiz').innerHTML = `
                    <div style="text-align: center; padding: 40px;">
                        <h2 style="font-size: 3rem; margin-bottom: 20px;">üéâ</h2>
                        <h3 style="font-size: 2rem; margin-bottom: 20px;">Quiz Complete!</h3>
                        <p style="font-size: 1.5rem; color: var(--success); margin-bottom: 20px;">
                            Score: ${state.quizScore}/50 (${percentage}%)
                        </p>
                        <p style="color: var(--text-secondary); margin-bottom: 30px;">
                            Excellent! You've mastered the nouns. Free drilling unlocked!
                        </p>
                        <button class="btn btn-primary" onclick="unlockPhase4()">Continue to Drilling ‚Üí</button>
                    </div>
                `;
                
                document.getElementById('badge-quiz').classList.remove('locked');
                document.getElementById('badge-quiz').classList.add('earned');
                
                createConfetti();
            } else {
                // Retry
                alert(`You scored ${percentage}%. You need 80% to pass. Let's try again!`);
                state.quizIndex = 0;
                state.quizScore = 0;
                state.quizNouns = [...nouns].sort(() => Math.random() - 0.5);
                showNextQuizQuestion();
            }
        }

        function unlockPhase4() {
            document.getElementById('phase4').style.display = 'block';
            document.getElementById('badge-phase4').classList.remove('locked');
            document.getElementById('badge-phase4').textContent = '‚è± 60 min';
            document.getElementById('phase4').scrollIntoView({ behavior: 'smooth' });
            
            // Add sentence counter
            const textarea = document.getElementById('drillTextarea');
            textarea.addEventListener('input', function() {
                const lines = this.value.split('\n').filter(line => line.trim().length > 0);
                state.sentenceCount = lines.length;
                document.getElementById('sentenceCount').textContent = lines.length;
                
                // Update badge
                if (lines.length >= 200) {
                    document.getElementById('badge-sentences').classList.remove('locked');
                    document.getElementById('badge-sentences').classList.add('earned');
                    unlockPhase5();
                }
                
                // Checkpoint every 50 sentences
                if (lines.length > 0 && lines.length % 50 === 0 && lines.length > state.checkpointsPassed * 50) {
                    state.checkpointsPassed++;
                    showCheckpoint();
                }
                
                updateProgress();
            });
        }

        function showCheckpoint() {
            // Simple checkpoint - just a motivational message
            alert(`üî• Great work! You've written ${state.sentenceCount} sentences. Keep going!`);
        }

        function unlockPhase5() {
            document.getElementById('phase5').style.display = 'block';
            document.getElementById('badge-phase5').classList.remove('locked');
            document.getElementById('badge-phase5').textContent = '‚è± 30 min';
            
            // Add counter for pronoun drill
            const textarea = document.getElementById('pronounTextarea');
            textarea.addEventListener('input', function() {
                const lines = this.value.split('\n').filter(line => line.trim().length > 0);
                document.getElementById('pronounCount').textContent = lines.length;
            });
        }

        function completePronounPhase() {
            const lines = document.getElementById('pronounTextarea').value.split('\n').filter(l => l.trim().length > 0);
            if (lines.length < 30) {
                alert('Please write at least 30 sentences!');
                return;
            }
            
            document.getElementById('phase6').style.display = 'block';
            document.getElementById('badge-phase6').classList.remove('locked');
            document.getElementById('badge-phase6').textContent = '‚è± 45 min';
            document.getElementById('phase6').scrollIntoView({ behavior: 'smooth' });
            
            // Add counter
            const textarea = document.getElementById('adjectiveTextarea');
            textarea.addEventListener('input', function() {
                const lines = this.value.split('\n').filter(line => line.trim().length > 0);
                document.getElementById('adjectiveCount').textContent = lines.length;
            });
            
            updateProgress();
        }

        function completeAdjectivePhase() {
            const lines = document.getElementById('adjectiveTextarea').value.split('\n').filter(l => l.trim().length > 0);
            if (lines.length < 50) {
                alert('Please write at least 50 sentences!');
                return;
            }
            
            document.getElementById('phase7').style.display = 'block';
            document.getElementById('badge-phase7').classList.remove('locked');
            document.getElementById('badge-phase7').textContent = '‚è± 30 min';
            document.getElementById('phase7').scrollIntoView({ behavior: 'smooth' });
            
            updateProgress();
        }

        function completeDay1() {
            const listening = document.getElementById('listeningCheck').checked;
            const speaking = document.getElementById('speakingCheck').checked;
            
            if (!listening || !speaking) {
                alert('Please complete both listening and speaking exercises!');
                return;
            }
            
            // Show completion card
            document.getElementById('completionCard').style.display = 'block';
            document.getElementById('completionCard').scrollIntoView({ behavior: 'smooth' });
            
            // Update final stats
            const totalSentences = state.sentenceCount + 
                                 parseInt(document.getElementById('pronounCount').textContent) +
                                 parseInt(document.getElementById('adjectiveCount').textContent);
            document.getElementById('finalSentences').textContent = totalSentences;
            document.getElementById('finalQuiz').textContent = `${(state.quizScore/50*100).toFixed(0)}%`;
            
            // Final badge
            document.getElementById('badge-complete').classList.remove('locked');
            document.getElementById('badge-complete').classList.add('earned');
            
            createConfetti();
            updateProgress();
        }

        // Helper functions
        function toggleCollapse(cardId) {
            document.getElementById(cardId).classList.toggle('collapsed');
        }

        function toggleHelp() {
            document.getElementById('helpPanel').classList.toggle('visible');
        }

        function populateHelpPanel() {
            const list = document.getElementById('helpVocabList');
            nouns.forEach(noun => {
                const li = document.createElement('li');
                li.className = `help-vocab-item ${noun.gender}`;
                li.textContent = `${noun.article} ${noun.word} - ${noun.translation}`;
                list.appendChild(li);
            });
        }

        function updateProgress() {
            let progress = 0;
            
            // Calculate progress based on completed phases
            if (state.groupsCompleted > 0) progress += (state.groupsCompleted / 5) * 30; // Groups = 30%
            if (state.quizScore === 50) progress += 20; // Quiz = 20%
            if (state.sentenceCount >= 200) progress += 30; // Drilling = 30%
            if (document.getElementById('pronounCount').textContent >= 30) progress += 10; // Pronouns = 10%
            if (document.getElementById('adjectiveCount') && document.getElementById('adjectiveCount').textContent >= 50) progress += 10; // Adjectives = 10%
            
            document.getElementById('mainProgress').style.width = progress + '%';
            document.getElementById('progressPercent').textContent = Math.round(progress) + '%';
        }

        function createConfetti() {
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.animationDelay = Math.random() * 3 + 's';
                confetti.style.background = ['var(--accent-a1)', 'var(--accent-a2)', 'var(--accent-der)', 'var(--accent-die)', 'var(--accent-das)'][Math.floor(Math.random() * 5)];
                document.body.appendChild(confetti);
                
                setTimeout(() => confetti.remove(), 3000);
            }
        }
    </script>
</body>
</html>